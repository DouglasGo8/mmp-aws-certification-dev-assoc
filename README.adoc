= AWS Certification - Developer Associate 2021

[.lead]

*_This course includes Quarkus v2.x, Apache Camel Quarkus v2.x and Terraform v1.x with all challenge details
founded over the Course_*

IMPORTANT: *_Install JSON Viewers on Browser_*

IMPORTANT: *_Why we need Cloud?_*

- Considering an Online Shop App, with peak load during a black friday, but you have less load out this time, this
mean waste resources in idle loads, company bought infrastructure to wait that such load, and the company falls in
1. Low infrastructure utilization
2. Needs ahead of time planning
3. High costs of procuring infrastructure
4. Dedicated infrastructure maintenance team

[.lead]

- With the Cloud you buy (renting just needed Resources), and release it when not need them,
On-demand resource provisioning offer low costs (pay per use)
- No upfront planning needed
- Avoiding "Undifferentiated heavy lifting"
- AWS provides most of 200+ services

== The main Links

- https://aws.amazon.com/[AWS Cloud]
- https://{{YOUR_IAM_ID}}.signin.aws.amazon.com/console[IAM User AWS Console]
- https://camel.apache.org/[Apache Camel]
- https://camel.apache.org/camel-quarkus/latest/[Apache Camel Extensions for Quarkus]
- https://quarkus.io/[Quarkus]
- https://code.quarkus.io/[Quarkus Coding]
- https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/#links[Asciidoctor Docs]

== IAM Section

1. Root User -> IAM User in a group with permissions
2. Never ever use Root User to create or manage resources
3. As Root user type go to IAM console search and create a group and after the user, *_e.g. DevGroup_* and their
policies -> *_e.g. DevUser_*, assign it to a  group, provides *_Programmatic access & AWS Management Console Access_*

== Regions and Zones

1. AWS provides multiple zones classified as regions (20+) that means multiple data centers spread around the world
us-east-1 is the most common region used, in general choose that region based on your users and data are located,
with regulatory and security compliance needs

image::content/pic/RegionsAWS.png[]

== EC2 Fundamentals:: https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance[Terraform aws_instance]

* EC2 Elastic Computer Cloud, represents rented virtual servers, virtual machines billed by second
* We can create and manage EC2 lifecycle of EC2 instances create load balancers and auto-scaling groups, EC2 have
ephemeral volumes, but we can attach permanent storages on them
* The SSH connection bellow is exclusively to Ubuntu Instances, in that case for AMZ instance must be ec2-user@public_ip

[source, bash]
----
ssh -i {{PEM}}.file ubuntu@public_ip
ps up $pid
----
* Security Groups Rules for EC2 Instances
** Security groups are *default deny*, if no rules configured no outbound/inbound traffic is allowed
** Can specify *allow rules ONLY*
** Can configure *separate rules* for inbound and outbound traffic
** Can add/delete sg groups to EC2 instances at any time
** Traffic NOT explicitly allowed by sg *will not reach the EC2 instance any way*
** Security Groups are stateful
** Timeout over responses is a typically SGs problem
** Common inbound rules to Security Groups in image bellow

image::content/pic/UsedTo_SG_InOutBound_Rules.png[]

* There are 270+ instance across 40+ instance types for different workloads to optimized combination of
compute(CPU, GPU), memory, disk (storage) and networking

* Classify a specification
** t2.micro
*** t - instance family
*** 2 - generation, improvements with each gen.
*** micro - size (nano < micro < small < medium < large < xlarge < ...)
##As sizes increases how much cpu/memory/storage/networking must increase proportionately##
*** Using metadata information over EC2 to get details about the instance (Runs the commands inside the EC2 Machine)
[source, bash]
----
sudo su
curl http:://169.254.169.254/latest/meta-data/
curl http:://169.254.169.254/latest/meta-data/ami-id
curl http:://169.254.169.254/latest/dynamic/instance-identity
----
*** Sample of using http:://169.254.169.254/latest/dynamic/instance-identity/document

image::content/pic/EC2_Metadata_Dynamic_Intance_identity_Document.png[]

*** *Terraform Sample to EC2 AMZ AMI using httpd Web Server* the curl command bellow is not recommended here just to Test

[source, hcl-terraform]
----
resource "aws_instance" "aws-ec2-micro-instance" {
  ami                    = lookup(var.amis, var.region)
  instance_type          = "t2.micro"
  vpc_security_group_ids = ["${data.aws_security_group.allow-ssh.id}"]
  key_name               = aws_key_pair.key-pub.key_name
  user_data = <<EOF
    #!/bin/bash
    sudo su
    yum update -y
    yum -y install httpd.x86_64
    sudo systemctl enable httpd
    sudo systemctl start httpd
    curl -s http:://169.254.169.254/latest/dynamic/instance-identity/document > /var/www/html/index.html
  EOF

  tags = {
    Name = "aws-ec2-micro-instance"
  }
}
----

* EC2 Rules for Public and Private IPs
** IP public are internet accessible
** IP private are just *internal*/corporate network access
** Cannot have two resources with the same public IP address
** Two different corporate nets can have resources with same private IP address
** All EC2 instances are assigned with IP private address
** Public IP creation in EC2 can be enabled for EC2 instances in public subnet
** When you stop an EC2 instance, public IP address is lost, Public IPs are ephemeral
